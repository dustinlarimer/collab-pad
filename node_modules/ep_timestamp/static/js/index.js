var tags = ['timestamp'];
exports.aceRegisterBlockElements = function(){
  return tags;
}

exports.aceAttribsToClasses = function(name, context) { 
	if (context.key == 'timestamp' && context.value) {
		return ['timestamp:' + context.value];
	}
}

exports.aceDomLineProcessLineAttributes = function(name, context) {
	var cls = context.cls;
	var domline = context.domline;
	var timestamp = /(?:^| )timestamp:(?:\d{4})\/(?:\d{2})\/(?:\d{2})(\s)(?:\d{2}):(?:\d{2}):(?:\d{1,2})/.exec(cls);
	var time_val = ''; 
	
	if (timestamp){
		console.log('regexp: ' + timestamp);
		time_val = timestamp[0].replace(' timestamp:', '');
	}
	var modifier = {
		preHtml: '<div class="line" data-timestamp="'+time_val+'">',
		postHtml: '</div>',
		processedMarker: true
	};
	return [modifier];
}

exports.aceInitInnerdocbodyHead = function(name, args, cb) {
  args.iframeHTML.push('<script type="text/javascript" src="/static/plugins/ep_timestamp/static/js/jquery.relativeDate.js"></script>');
  return cb();
};